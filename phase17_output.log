Using device: cuda
  GPU: NVIDIA GeForce RTX 4090
  VRAM: 25.3 GB
======================================================================
PHASE 17: SPIRNOR-RoPE IN PRETRAINED LANGUAGE MODELS
Model: EleutherAI/pythia-70m
======================================================================

Loading tokenizer...
Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
  Vocab size: 50254
Loading base model for inspection...
Loading weights:   0%|          | 0/76 [00:00<?, ?it/s]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 20460.02it/s, Materializing param=embed_out.weight]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 8176.03it/s, Materializing param=embed_out.weight] Loading weights:   3%|▎         | 2/76 [00:00<00:00, 7943.76it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   3%|▎         | 2/76 [00:00<00:00, 6364.65it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 4198.50it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 3853.88it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 4372.48it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 4041.73it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 4451.61it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 4229.83it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 4554.90it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 3657.29it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 3950.50it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 3833.92it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:  11%|█         | 8/76 [00:00<00:00, 4114.08it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  11%|█         | 8/76 [00:00<00:00, 3991.25it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 4222.45it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]            Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 4113.86it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 4327.15it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 4076.89it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 4281.89it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 4046.43it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 3983.51it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 3911.68it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 3917.66it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]  Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 3828.26it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 3990.23it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 3930.93it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 3485.38it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 3273.39it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  21%|██        | 16/76 [00:00<00:00, 3111.79it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  21%|██        | 16/76 [00:00<00:00, 3004.92it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 3089.26it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]           Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 3052.49it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 3152.30it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 3116.25it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 3214.41it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 3179.53it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 3272.45it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 3238.84it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 3326.55it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]            Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 3245.17it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 3332.78it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 3301.18it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  30%|███       | 23/76 [00:00<00:00, 3204.20it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  30%|███       | 23/76 [00:00<00:00, 3179.49it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 3265.85it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 3235.20it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 3194.64it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]  Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 3099.73it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 3167.81it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 3144.79it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 3218.41it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 3177.41it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 3249.42it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 3226.74it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 3299.82it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]           Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 3276.45it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 3348.30it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 3328.37it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  41%|████      | 31/76 [00:00<00:00, 3400.02it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  41%|████      | 31/76 [00:00<00:00, 3379.69it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 3447.31it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 3420.34it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 3483.90it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]            Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 3463.59it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 3530.47it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 3510.57it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 3574.14it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 3553.63it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 3619.25it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 3591.27it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 3656.59it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]  Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 3639.35it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 3706.08it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 3689.35it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 3749.98it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 3732.69it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3797.90it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3780.70it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3843.94it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]           Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3826.92it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3888.24it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3871.41it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3932.47it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3915.32it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3972.05it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3954.77it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 4013.26it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]            Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3996.52it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 4052.72it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 4034.33it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 4091.32it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 4074.58it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 4130.37it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 4113.91it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 4166.75it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]  Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 4150.09it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 4203.97it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 4187.52it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 4240.53it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 4223.79it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 4276.13it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 4259.34it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 4310.44it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]           Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 4290.64it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 4340.27it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 4323.94it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 4373.29it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 4356.69it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 4405.04it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 4388.17it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 4436.11it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]            Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 4419.22it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 4464.24it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 4447.91it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 4495.42it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 4478.90it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 4524.68it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 4508.31it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  80%|████████  | 61/76 [00:00<00:00, 4549.14it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]  Loading weights:  80%|████████  | 61/76 [00:00<00:00, 4532.62it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 4576.92it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 4560.79it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 4604.71it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 4586.80it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 4630.91it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 4614.04it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 4657.39it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]           Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 4641.77it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 4684.07it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 4668.83it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 4710.88it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 4695.38it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 4734.84it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 4717.85it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 4758.26it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]            Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 4742.98it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 4784.97it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 4769.66it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4810.06it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4792.56it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4832.15it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4817.04it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4855.90it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]  Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4840.86it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4879.32it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4864.33it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4902.25it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4883.23it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4920.23it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4905.17it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4873.07it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]
  d_model: 512
  n_heads: 8
  n_layers: 6
  d_head: 64
  rotary_pct: 0.25
  Rotary dim: 16 -> 8 frequency pairs
  Standard inv_freq: [1.0, 0.3162277638912201, 0.10000000149011612, 0.03162277862429619, 0.009999999776482582, 0.003162277862429619, 0.0010000000474974513, 0.0003162277862429619]

----------------------------------------------------------------------
DATA GENERATION
----------------------------------------------------------------------
Generating training data: 8334 per task x 6 tasks = ~50,004 examples
  Total training examples: 50,004
  [mod7] '466 mod 7 = 4'
  [mod7] '217 mod 7 = 0'
  [mod30] '137 mod 30 = 17'
  [mod30] '1343 mod 30 = 23'
  [gcd_task] 'gcd(322,1632) = 2'
  [gcd_task] 'gcd(1450,477) = 1'
  [isprime] 'is_prime(1012) = no'
  [isprime] 'is_prime(476) = no'
  [add] '1905 + 100 = 2005'
  [add] '1433 + 787 = 2220'
  [coprime] 'coprime(57,335) = yes'
  [coprime] 'coprime(1254,1169) = yes'

Tokenizing training data...
  Label check OK: all 50004 examples have valid answer tokens
  Shape: input_ids=torch.Size([50004, 48]), labels=torch.Size([50004, 48])

======================================================================
[1/5] CONFIG: zero_shot
  Pretrained Pythia-70M (no fine-tuning)
======================================================================
Loading weights:   0%|          | 0/76 [00:00<?, ?it/s]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 52428.80it/s, Materializing param=embed_out.weight]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 1833.98it/s, Materializing param=embed_out.weight] Loading weights:   3%|▎         | 2/76 [00:00<00:00, 3007.75it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   3%|▎         | 2/76 [00:00<00:00, 2792.48it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 3556.50it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 2525.67it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 3052.07it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 2202.89it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 1922.23it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 1879.00it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 1836.52it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 1796.79it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 2019.54it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 1870.07it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:  11%|█         | 8/76 [00:00<00:00, 2054.52it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  11%|█         | 8/76 [00:00<00:00, 2011.90it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 2193.80it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]            Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 2072.51it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 2151.59it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 2031.34it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 2071.73it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 2049.09it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 2183.11it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 2120.83it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 2170.79it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]  Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 2123.28it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 2197.29it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 2126.16it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 2094.71it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 2051.87it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  21%|██        | 16/76 [00:00<00:00, 2153.20it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  21%|██        | 16/76 [00:00<00:00, 2136.82it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 2237.24it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]           Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 2221.28it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 2313.39it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 2281.10it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 2338.44it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 2278.08it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 2329.20it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 2312.44it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 2391.47it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]            Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 2375.22it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 2448.71it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 2434.24it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  30%|███       | 23/76 [00:00<00:00, 2513.00it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  30%|███       | 23/76 [00:00<00:00, 2498.68it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 2574.51it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 2560.17it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 2633.03it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]  Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 2618.62it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 2690.31it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 2675.86it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 2745.43it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 2700.39it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 2556.22it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 2509.90it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 2568.63it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]           Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 2555.84it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 2615.50it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 2603.49it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  41%|████      | 31/76 [00:00<00:00, 2662.89it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  41%|████      | 31/76 [00:00<00:00, 2650.35it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 2707.48it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 2688.82it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 2720.47it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]            Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 2706.69it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 2764.06it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 2749.04it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 2804.38it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 2791.58it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 2845.53it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 2832.50it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 2885.36it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]  Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 2864.06it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 2919.01it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 2908.30it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 2965.09it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 2954.48it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3010.61it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3000.11it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3055.44it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]           Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3044.79it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3098.97it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3088.43it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3142.35it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3131.60it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3184.08it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3170.08it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3220.06it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]            Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3209.33it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3261.13it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3250.47it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3301.72it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3291.02it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3341.08it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3328.43it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3377.06it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]  Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3366.22it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3415.00it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3404.08it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3451.43it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3440.22it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3484.31it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3473.05it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3519.77it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]           Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3508.83it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3554.61it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3543.87it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3589.17it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3578.26it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3622.64it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3611.50it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3655.59it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]            Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3644.77it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3689.65it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3678.94it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3722.55it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3707.10it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3748.93it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3738.24it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3780.61it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]  Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3769.97it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3812.05it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3799.69it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 3840.10it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 3829.30it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 3870.29it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 3859.27it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 3900.06it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]           Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 3889.38it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 3928.87it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 3917.97it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 3952.10it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 3940.96it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 3979.47it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 3968.51it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 4006.35it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]            Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 3995.51it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 4033.65it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 4023.09it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4061.14it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4050.65it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4087.90it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4077.14it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4114.11it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]  Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4103.41it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4137.94it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4126.06it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4161.57it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4150.58it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4184.56it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4173.60it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4150.45it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]
  Total params: 70,426,624
  Trainable params: 70,426,624
  (No fine-tuning — zero-shot evaluation)

  Debug (3 examples):
    [mod7] prompt='466 mod 7 =' expected='4' got='' clean='' [MISS]
    [gcd_task] prompt='gcd(466,322) =' expected='2' got='-$!!!' clean='-$!!!' [MISS]
    [coprime] prompt='coprime(466,322) =' expected='no' got='&!$!' clean='&!$!' [MISS]

  Evaluation (500 per task per range):
    in_range      : overall=0.0000  [mod7=0.000 mod30=0.000 gcd_task=0.000 isprime=0.000 add=0.000 coprime=0.000]
    ood_2k_5k     : overall=0.0010  [mod7=0.004 mod30=0.002 gcd_task=0.000 isprime=0.000 add=0.000 coprime=0.000]
    ood_5k_20k    : overall=0.0007  [mod7=0.002 mod30=0.002 gcd_task=0.000 isprime=0.000 add=0.000 coprime=0.000]
    ood_20k_100k  : overall=0.0000  [mod7=0.000 mod30=0.000 gcd_task=0.000 isprime=0.000 add=0.000 coprime=0.000]

======================================================================
[2/5] CONFIG: baseline_ft
  Standard RoPE, fine-tuned
======================================================================
Loading weights:   0%|          | 0/76 [00:00<?, ?it/s]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 50533.78it/s, Materializing param=embed_out.weight]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 3869.28it/s, Materializing param=embed_out.weight] Loading weights:   3%|▎         | 2/76 [00:00<00:00, 5346.47it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   3%|▎         | 2/76 [00:00<00:00, 2828.26it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 2830.80it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 2657.99it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 3176.90it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 3030.02it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 3101.38it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 2685.21it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 2648.20it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 2384.26it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 2631.07it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 2444.23it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:  11%|█         | 8/76 [00:00<00:00, 2543.54it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  11%|█         | 8/76 [00:00<00:00, 2309.16it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 2311.19it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]            Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 2235.64it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 2395.24it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 2174.45it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 2161.20it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 2077.23it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 2063.11it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 2005.72it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 1965.39it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]  Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 1947.22it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 2054.38it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 2034.80it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 2085.20it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 2068.40it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  21%|██        | 16/76 [00:00<00:00, 2082.38it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  21%|██        | 16/76 [00:00<00:00, 2066.35it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 2139.76it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]           Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 2083.24it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 2149.27it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 2133.60it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 2221.37it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 2206.18it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 2286.60it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 2228.58it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 2252.70it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]            Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 2239.07it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 2315.72it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 2302.72it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  30%|███       | 23/76 [00:00<00:00, 2378.13it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  30%|███       | 23/76 [00:00<00:00, 2364.84it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 2435.19it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 2418.45it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 2491.45it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]  Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 2478.43it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 2489.71it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 2476.09it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 2541.15it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 2527.76it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 2590.28it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 2555.39it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 2593.44it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]           Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 2526.90it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 2575.35it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 2563.65it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  41%|████      | 31/76 [00:00<00:00, 2624.19it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  41%|████      | 31/76 [00:00<00:00, 2598.65it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 2659.41it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 2648.39it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 2709.92it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]            Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 2697.99it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 2758.61it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 2747.18it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 2806.31it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 2794.77it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 2852.57it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 2840.44it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 2897.11it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]  Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 2882.15it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 2937.35it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 2925.54it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 2980.21it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 2968.10it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3018.90it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3006.24it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3061.26it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]           Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3050.29it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3104.26it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3093.36it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3146.62it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3135.41it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3185.90it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3173.73it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3224.79it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]            Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3213.70it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3265.38it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3254.58it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3305.59it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3294.76it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3344.30it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3333.39it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3382.61it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]  Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3371.63it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3419.85it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3408.84it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3456.34it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3442.49it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3489.33it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3478.14it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3524.68it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]           Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3513.54it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3556.84it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3545.76it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3590.57it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3579.26it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3623.48it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3612.22it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3655.92it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]            Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3645.00it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3689.03it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3678.27it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3718.86it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3707.82it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3749.88it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3738.68it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3780.33it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]  Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3768.30it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3809.48it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3798.47it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 3838.87it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 3827.47it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 3867.78it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 3856.39it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 3896.38it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]           Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 3885.28it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 3922.35it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 3910.28it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 3948.66it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 3937.49it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 3972.87it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 3961.67it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 3998.27it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]            Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 3987.42it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 4025.85it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 4015.12it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4052.80it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4041.91it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4078.19it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4067.37it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4102.20it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]  Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4090.47it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4125.78it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4115.06it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4150.58it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4139.55it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4175.08it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4163.95it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4141.07it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]
  Total params: 70,426,624
  Trainable params: 70,426,624

  Fine-tuning (10 epochs)...
    AMP dtype: torch.bfloat16, GradScaler: False
    Epoch  1/10: loss=1.7638, lr=2.00e-05, time=23s
    Epoch  2/10: loss=1.3718, lr=1.94e-05, time=45s
    Epoch  5/10: loss=1.0305, lr=1.17e-05, time=115s
    Epoch  8/10: loss=0.8324, lr=2.34e-06, time=186s
    Epoch 10/10: loss=0.7503, lr=0.00e+00, time=231s
  Training time: 230.9s

  Debug (3 examples):
    [mod7] prompt='466 mod 7 =' expected='4' got='2' clean='2' [MISS]
    [gcd_task] prompt='gcd(466,322) =' expected='2' got='2' clean='2' [OK]
    [coprime] prompt='coprime(466,322) =' expected='no' got='no' clean='no' [OK]

  Evaluation (500 per task per range):
    in_range      : overall=0.6040  [mod7=0.390 mod30=0.746 gcd_task=0.726 isprime=0.928 add=0.000 coprime=0.834]
    ood_2k_5k     : overall=0.4040  [mod7=0.114 mod30=0.188 gcd_task=0.624 isprime=0.840 add=0.000 coprime=0.658]
    ood_5k_20k    : overall=0.4303  [mod7=0.150 mod30=0.266 gcd_task=0.662 isprime=0.818 add=0.000 coprime=0.686]
    ood_20k_100k  : overall=0.4203  [mod7=0.158 mod30=0.216 gcd_task=0.668 isprime=0.820 add=0.000 coprime=0.660]

======================================================================
[3/5] CONFIG: spirnor_rope_ft
  SPIRNOR RoPE frequencies, fine-tuned
======================================================================
Loading weights:   0%|          | 0/76 [00:00<?, ?it/s]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 53092.46it/s, Materializing param=embed_out.weight]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 12748.64it/s, Materializing param=embed_out.weight]Loading weights:   3%|▎         | 2/76 [00:00<00:00, 7523.42it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   3%|▎         | 2/76 [00:00<00:00, 2831.12it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 3357.23it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 3171.10it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 3776.10it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 3228.87it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 3630.17it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 3184.26it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 2712.13it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 2544.57it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 2629.66it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 2427.46it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:  11%|█         | 8/76 [00:00<00:00, 2651.06it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  11%|█         | 8/76 [00:00<00:00, 2604.35it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 2811.41it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]            Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 2733.24it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 2940.28it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 2896.62it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 3072.14it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 3026.79it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 3197.69it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 3152.62it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 3311.43it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]  Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 3268.55it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 3420.73it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 2955.82it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 2981.59it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 2851.59it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  21%|██        | 16/76 [00:00<00:00, 2907.79it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  21%|██        | 16/76 [00:00<00:00, 2879.10it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 2995.68it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]           Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 2968.74it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 3080.27it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 3049.05it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 3149.75it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 3118.56it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 3128.68it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 3048.19it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 3140.12it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]            Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 3112.49it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 3098.03it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 3066.11it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  30%|███       | 23/76 [00:00<00:00, 3102.20it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  30%|███       | 23/76 [00:00<00:00, 3080.50it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 3165.41it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 3143.37it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 3225.20it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]  Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 3203.72it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 3280.05it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 3223.24it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 3296.26it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 3267.16it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 3264.87it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 3241.35it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 3309.25it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]           Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 3249.49it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 3203.23it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 3166.79it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  41%|████      | 31/76 [00:00<00:00, 3234.25it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  41%|████      | 31/76 [00:00<00:00, 3216.97it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 3286.03it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 3268.82it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 3330.90it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]            Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 3231.89it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 3155.78it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 3004.64it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 3000.09it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 2985.63it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 3039.47it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 3024.25it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 3075.06it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]  Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 3059.79it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 3038.60it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 3002.37it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 2988.16it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 2975.28it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3026.58it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3014.45it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3068.15it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]           Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3056.31it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3108.92it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3097.11it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3148.93it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3137.10it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3187.82it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3174.55it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3224.73it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]            Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3213.48it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3264.77it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3251.34it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3301.55it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3290.36it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3339.58it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3328.10it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3376.45it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]  Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3365.17it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3413.28it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3402.26it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3449.65it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3438.29it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3485.65it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3474.76it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3497.23it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]           Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3485.66it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3531.22it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3520.68it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3566.09it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3555.15it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3599.54it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3588.76it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3632.76it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]            Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3622.02it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3666.40it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3654.62it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3697.91it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3687.16it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3729.49it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3716.16it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3757.23it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]  Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3746.67it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3788.51it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3777.83it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 3818.90it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 3808.00it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 3848.76it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 3837.97it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 3878.31it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]           Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 3867.47it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 3906.74it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 3896.02it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 3934.56it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 3923.58it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 3945.07it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 3932.88it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 3970.03it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]            Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 3959.54it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 3997.73it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 3986.98it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4024.26it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4013.63it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4049.26it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4038.70it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4075.39it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]  Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4064.95it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4071.66it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4060.31it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4095.47it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4084.94it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4120.35it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4109.84it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4087.81it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]
  RoPE replacement: 8 frequency pairs
  Old inv_freq: [1.0, 0.3162277638912201, 0.10000000149011612, 0.03162277862429619, 0.009999999776482582, 0.003162277862429619, 0.0010000000474974513, 0.0003162277862429619]
  New inv_freq (SPIRNOR): [3.1415927410125732, 2.094395160675049, 1.2566370964050293, 0.8975979089736938, 0.5711986422538757, 0.4833219349384308, 0.3695991337299347, 0.33069396018981934]
  Primes used: [2, 3, 5, 7, 11, 13, 17, 19]
  CRT product: 9,699,690
  Total params: 70,426,624
  Trainable params: 70,426,624

  Fine-tuning (10 epochs)...
    AMP dtype: torch.bfloat16, GradScaler: False
    Epoch  1/10: loss=1.6446, lr=2.00e-05, time=22s
    Epoch  2/10: loss=1.3035, lr=1.94e-05, time=46s
    Epoch  5/10: loss=0.9927, lr=1.17e-05, time=115s
    Epoch  8/10: loss=0.8413, lr=2.34e-06, time=186s
    Epoch 10/10: loss=0.7733, lr=0.00e+00, time=236s
  Training time: 235.5s

  Debug (3 examples):
    [mod7] prompt='466 mod 7 =' expected='4' got='4' clean='4' [OK]
    [gcd_task] prompt='gcd(466,322) =' expected='2' got='2' clean='2' [OK]
    [coprime] prompt='coprime(466,322) =' expected='no' got='no' clean='no' [OK]

  Evaluation (500 per task per range):
    in_range      : overall=0.5897  [mod7=0.328 mod30=0.656 gcd_task=0.760 isprime=0.926 add=0.002 coprime=0.866]
    ood_2k_5k     : overall=0.4813  [mod7=0.138 mod30=0.298 gcd_task=0.762 isprime=0.854 add=0.000 coprime=0.836]
    ood_5k_20k    : overall=0.4673  [mod7=0.116 mod30=0.280 gcd_task=0.762 isprime=0.858 add=0.000 coprime=0.788]
    ood_20k_100k  : overall=0.4827  [mod7=0.128 mod30=0.314 gcd_task=0.782 isprime=0.830 add=0.000 coprime=0.842]

======================================================================
[4/5] CONFIG: spirnor_value_ft
  Standard RoPE + SPIRNOR value augmentation, fine-tuned
======================================================================
Loading weights:   0%|          | 0/76 [00:00<?, ?it/s]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 59074.70it/s, Materializing param=embed_out.weight]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 12520.31it/s, Materializing param=embed_out.weight]Loading weights:   3%|▎         | 2/76 [00:00<00:00, 10618.49it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   3%|▎         | 2/76 [00:00<00:00, 8248.39it/s, Materializing param=gpt_neox.embed_in.weight] Loading weights:   4%|▍         | 3/76 [00:00<00:00, 3309.55it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 2321.14it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 2814.02it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 2705.13it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 3153.14it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 3042.44it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 3375.70it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 3267.02it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 3526.74it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 3423.12it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:  11%|█         | 8/76 [00:00<00:00, 3674.38it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  11%|█         | 8/76 [00:00<00:00, 3563.55it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 3772.23it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]            Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 3675.27it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 3128.21it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 2969.00it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 2932.89it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 2824.79it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 2670.68it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 2633.51it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 2769.92it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]  Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 2734.78it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 2744.96it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 2653.78it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 2471.79it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 2361.39it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  21%|██        | 16/76 [00:00<00:00, 2434.30it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  21%|██        | 16/76 [00:00<00:00, 2411.04it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 2478.99it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]           Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 2411.91it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 2502.24it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 2395.68it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 2433.34it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 2313.59it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 2219.50it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 2202.83it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 2254.02it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]            Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 2197.72it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 2246.55it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 2156.05it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  30%|███       | 23/76 [00:00<00:00, 2196.12it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  30%|███       | 23/76 [00:00<00:00, 2138.10it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 2199.76it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 2137.22it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 2199.33it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]  Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 2187.63it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 2251.98it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 2240.41it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 2303.91it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 2291.83it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 2351.77it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 2334.01it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 2394.62it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]           Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 2382.94it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 2444.76it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 2434.73it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  41%|████      | 31/76 [00:00<00:00, 2496.03it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  41%|████      | 31/76 [00:00<00:00, 2485.68it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 2545.71it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 2534.99it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 2592.33it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]            Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 2581.69it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 2638.90it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 2627.38it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 2684.82it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 2674.21it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 2730.52it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 2720.92it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 2777.73it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]  Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 2767.88it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 2823.75it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 2813.63it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 2868.63it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 2858.50it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 2913.22it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 2903.03it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 2955.00it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]           Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 2943.88it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 2995.93it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 2985.88it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3038.02it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3027.21it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3077.21it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3066.78it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3116.95it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]            Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3106.59it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3156.60it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3146.46it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3195.89it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3184.48it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3232.24it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3219.37it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3266.18it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]  Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3255.72it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3302.19it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3291.87it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3338.27it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3327.67it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3373.82it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3363.41it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3409.11it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]           Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3398.74it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3443.44it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3433.21it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3477.65it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3467.15it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3507.62it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3497.02it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3539.86it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]            Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3529.52it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3570.93it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3560.22it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3602.88it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3592.79it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3634.16it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3623.59it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3664.14it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]  Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3652.38it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3690.70it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3680.20it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 3717.36it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 3706.57it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 3746.01it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 3734.91it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 3773.68it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]           Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 3763.32it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 3801.59it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 3791.54it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 3829.79it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 3819.48it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 3857.25it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 3846.84it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 3884.29it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]            Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 3874.26it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 3910.15it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 3899.29it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 3936.49it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 3926.47it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 3963.02it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 3952.18it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 3986.88it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]  Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 3976.73it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4012.18it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4002.15it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4036.14it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4025.60it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4060.37it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4050.20it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4025.24it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]
  Total params: 70,432,256
  Trainable params: 70,432,256
  Value aug params: 5,632

  Fine-tuning (10 epochs)...
    AMP dtype: torch.bfloat16, GradScaler: False
    Epoch  1/10: loss=1.5325, lr=2.00e-05, time=88s
    Epoch  2/10: loss=0.9534, lr=1.94e-05, time=174s
    Epoch  5/10: loss=0.6740, lr=1.17e-05, time=435s
    Epoch  8/10: loss=0.5029, lr=2.34e-06, time=698s
    Epoch 10/10: loss=0.4127, lr=0.00e+00, time=872s
  Training time: 872.4s

  Debug (3 examples):
    [mod7] prompt='466 mod 7 =' expected='4' got='4' clean='4' [OK]
    [gcd_task] prompt='gcd(466,322) =' expected='2' got='2' clean='2' [OK]
    [coprime] prompt='coprime(466,322) =' expected='no' got='no' clean='no' [OK]

  Evaluation (500 per task per range):
    in_range      : overall=0.7957  [mod7=1.000 mod30=0.996 gcd_task=0.844 isprime=0.986 add=0.000 coprime=0.948]
    ood_2k_5k     : overall=0.7290  [mod7=0.884 mod30=0.860 gcd_task=0.842 isprime=0.888 add=0.000 coprime=0.900]
    ood_5k_20k    : overall=0.7477  [mod7=0.910 mod30=0.932 gcd_task=0.820 isprime=0.880 add=0.000 coprime=0.944]
    ood_20k_100k  : overall=0.7277  [mod7=0.870 mod30=0.882 gcd_task=0.824 isprime=0.902 add=0.000 coprime=0.888]

======================================================================
[5/5] CONFIG: spirnor_full_ft
  SPIRNOR RoPE + value augmentation, fine-tuned
======================================================================
Loading weights:   0%|          | 0/76 [00:00<?, ?it/s]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 58254.22it/s, Materializing param=embed_out.weight]Loading weights:   1%|▏         | 1/76 [00:00<00:00, 2532.79it/s, Materializing param=embed_out.weight] Loading weights:   3%|▎         | 2/76 [00:00<00:00, 3085.18it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   3%|▎         | 2/76 [00:00<00:00, 1731.39it/s, Materializing param=gpt_neox.embed_in.weight]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 1735.81it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   4%|▍         | 3/76 [00:00<00:00, 1238.11it/s, Materializing param=gpt_neox.final_layer_norm.bias]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 1556.18it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   5%|▌         | 4/76 [00:00<00:00, 1458.00it/s, Materializing param=gpt_neox.final_layer_norm.weight]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 1619.05it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   7%|▋         | 5/76 [00:00<00:00, 1404.84it/s, Materializing param=gpt_neox.layers.0.attention.dense.bias]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 1619.53it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   8%|▊         | 6/76 [00:00<00:00, 1562.22it/s, Materializing param=gpt_neox.layers.0.attention.dense.weight]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 1755.78it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:   9%|▉         | 7/76 [00:00<00:00, 1711.46it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.bias]Loading weights:  11%|█         | 8/76 [00:00<00:00, 1856.30it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  11%|█         | 8/76 [00:00<00:00, 1780.83it/s, Materializing param=gpt_neox.layers.0.attention.query_key_value.weight]Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 1895.49it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]            Loading weights:  12%|█▏        | 9/76 [00:00<00:00, 1871.25it/s, Materializing param=gpt_neox.layers.0.input_layernorm.bias]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 2022.03it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  13%|█▎        | 10/76 [00:00<00:00, 1992.64it/s, Materializing param=gpt_neox.layers.0.input_layernorm.weight]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 2106.25it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  14%|█▍        | 11/76 [00:00<00:00, 1981.59it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.bias]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 2029.09it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  16%|█▌        | 12/76 [00:00<00:00, 1951.75it/s, Materializing param=gpt_neox.layers.0.mlp.dense_4h_to_h.weight]Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 2015.97it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]  Loading weights:  17%|█▋        | 13/76 [00:00<00:00, 1940.15it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.bias]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 2049.00it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  18%|█▊        | 14/76 [00:00<00:00, 2031.07it/s, Materializing param=gpt_neox.layers.0.mlp.dense_h_to_4h.weight]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 1986.00it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  20%|█▉        | 15/76 [00:00<00:00, 1930.01it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.bias]Loading weights:  21%|██        | 16/76 [00:00<00:00, 1988.65it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  21%|██        | 16/76 [00:00<00:00, 1969.91it/s, Materializing param=gpt_neox.layers.0.post_attention_layernorm.weight]Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 2004.76it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]           Loading weights:  22%|██▏       | 17/76 [00:00<00:00, 1965.30it/s, Materializing param=gpt_neox.layers.1.attention.dense.bias]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 2027.81it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  24%|██▎       | 18/76 [00:00<00:00, 1979.53it/s, Materializing param=gpt_neox.layers.1.attention.dense.weight]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 2014.25it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  25%|██▌       | 19/76 [00:00<00:00, 1978.45it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.bias]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 2057.59it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  26%|██▋       | 20/76 [00:00<00:00, 2038.84it/s, Materializing param=gpt_neox.layers.1.attention.query_key_value.weight]Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 2118.28it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]            Loading weights:  28%|██▊       | 21/76 [00:00<00:00, 2104.57it/s, Materializing param=gpt_neox.layers.1.input_layernorm.bias]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 2183.60it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  29%|██▉       | 22/76 [00:00<00:00, 2172.70it/s, Materializing param=gpt_neox.layers.1.input_layernorm.weight]Loading weights:  30%|███       | 23/76 [00:00<00:00, 2249.53it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  30%|███       | 23/76 [00:00<00:00, 2238.31it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.bias]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 2314.21it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  32%|███▏      | 24/76 [00:00<00:00, 2302.77it/s, Materializing param=gpt_neox.layers.1.mlp.dense_4h_to_h.weight]Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 2376.97it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]  Loading weights:  33%|███▎      | 25/76 [00:00<00:00, 2366.35it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.bias]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 2440.90it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  34%|███▍      | 26/76 [00:00<00:00, 2430.34it/s, Materializing param=gpt_neox.layers.1.mlp.dense_h_to_4h.weight]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 2503.51it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  36%|███▌      | 27/76 [00:00<00:00, 2492.43it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.bias]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 2564.37it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  37%|███▋      | 28/76 [00:00<00:00, 2550.45it/s, Materializing param=gpt_neox.layers.1.post_attention_layernorm.weight]Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 2620.31it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]           Loading weights:  38%|███▊      | 29/76 [00:00<00:00, 2608.73it/s, Materializing param=gpt_neox.layers.2.attention.dense.bias]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 2677.56it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  39%|███▉      | 30/76 [00:00<00:00, 2666.15it/s, Materializing param=gpt_neox.layers.2.attention.dense.weight]Loading weights:  41%|████      | 31/76 [00:00<00:00, 2733.94it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  41%|████      | 31/76 [00:00<00:00, 2722.15it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.bias]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 2786.39it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  42%|████▏     | 32/76 [00:00<00:00, 2774.58it/s, Materializing param=gpt_neox.layers.2.attention.query_key_value.weight]Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 2839.86it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]            Loading weights:  43%|████▎     | 33/76 [00:00<00:00, 2828.49it/s, Materializing param=gpt_neox.layers.2.input_layernorm.bias]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 2893.33it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  45%|████▍     | 34/76 [00:00<00:00, 2881.75it/s, Materializing param=gpt_neox.layers.2.input_layernorm.weight]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 2945.56it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  46%|████▌     | 35/76 [00:00<00:00, 2932.08it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.bias]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 2992.72it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  47%|████▋     | 36/76 [00:00<00:00, 2981.03it/s, Materializing param=gpt_neox.layers.2.mlp.dense_4h_to_h.weight]Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 3042.09it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]  Loading weights:  49%|████▊     | 37/76 [00:00<00:00, 3029.15it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.bias]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 3089.01it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  50%|█████     | 38/76 [00:00<00:00, 3077.26it/s, Materializing param=gpt_neox.layers.2.mlp.dense_h_to_4h.weight]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 3136.38it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  51%|█████▏    | 39/76 [00:00<00:00, 3124.64it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.bias]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3183.29it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  53%|█████▎    | 40/76 [00:00<00:00, 3171.32it/s, Materializing param=gpt_neox.layers.2.post_attention_layernorm.weight]Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3228.93it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]           Loading weights:  54%|█████▍    | 41/76 [00:00<00:00, 3217.09it/s, Materializing param=gpt_neox.layers.3.attention.dense.bias]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3273.63it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  55%|█████▌    | 42/76 [00:00<00:00, 3261.69it/s, Materializing param=gpt_neox.layers.3.attention.dense.weight]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3314.62it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  57%|█████▋    | 43/76 [00:00<00:00, 3301.21it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.bias]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3355.02it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  58%|█████▊    | 44/76 [00:00<00:00, 3342.74it/s, Materializing param=gpt_neox.layers.3.attention.query_key_value.weight]Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3396.32it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]            Loading weights:  59%|█████▉    | 45/76 [00:00<00:00, 3384.14it/s, Materializing param=gpt_neox.layers.3.input_layernorm.bias]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3437.28it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  61%|██████    | 46/76 [00:00<00:00, 3425.08it/s, Materializing param=gpt_neox.layers.3.input_layernorm.weight]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3476.45it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  62%|██████▏   | 47/76 [00:00<00:00, 3464.36it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.bias]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3515.64it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  63%|██████▎   | 48/76 [00:00<00:00, 3503.53it/s, Materializing param=gpt_neox.layers.3.mlp.dense_4h_to_h.weight]Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3553.94it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]  Loading weights:  64%|██████▍   | 49/76 [00:00<00:00, 3541.57it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.bias]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3591.14it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  66%|██████▌   | 50/76 [00:00<00:00, 3575.77it/s, Materializing param=gpt_neox.layers.3.mlp.dense_h_to_4h.weight]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3624.29it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  67%|██████▋   | 51/76 [00:00<00:00, 3611.63it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.bias]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3658.17it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  68%|██████▊   | 52/76 [00:00<00:00, 3645.88it/s, Materializing param=gpt_neox.layers.3.post_attention_layernorm.weight]Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3693.58it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]           Loading weights:  70%|██████▉   | 53/76 [00:00<00:00, 3681.53it/s, Materializing param=gpt_neox.layers.4.attention.dense.bias]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3728.21it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  71%|███████   | 54/76 [00:00<00:00, 3716.22it/s, Materializing param=gpt_neox.layers.4.attention.dense.weight]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3762.69it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  72%|███████▏  | 55/76 [00:00<00:00, 3750.39it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.bias]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3796.24it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  74%|███████▎  | 56/76 [00:00<00:00, 3784.07it/s, Materializing param=gpt_neox.layers.4.attention.query_key_value.weight]Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3829.31it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]            Loading weights:  75%|███████▌  | 57/76 [00:00<00:00, 3815.62it/s, Materializing param=gpt_neox.layers.4.input_layernorm.bias]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3859.28it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  76%|███████▋  | 58/76 [00:00<00:00, 3847.26it/s, Materializing param=gpt_neox.layers.4.input_layernorm.weight]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3892.11it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  78%|███████▊  | 59/76 [00:00<00:00, 3880.14it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.bias]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3923.70it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  79%|███████▉  | 60/76 [00:00<00:00, 3911.75it/s, Materializing param=gpt_neox.layers.4.mlp.dense_4h_to_h.weight]Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3954.63it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]  Loading weights:  80%|████████  | 61/76 [00:00<00:00, 3942.68it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.bias]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3985.45it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  82%|████████▏ | 62/76 [00:00<00:00, 3973.27it/s, Materializing param=gpt_neox.layers.4.mlp.dense_h_to_4h.weight]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 4015.33it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  83%|████████▎ | 63/76 [00:00<00:00, 4003.47it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.bias]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 4045.51it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  84%|████████▍ | 64/76 [00:00<00:00, 4033.59it/s, Materializing param=gpt_neox.layers.4.post_attention_layernorm.weight]Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 4073.05it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]           Loading weights:  86%|████████▌ | 65/76 [00:00<00:00, 4058.98it/s, Materializing param=gpt_neox.layers.5.attention.dense.bias]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 4098.67it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  87%|████████▋ | 66/76 [00:00<00:00, 4086.81it/s, Materializing param=gpt_neox.layers.5.attention.dense.weight]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 4126.98it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  88%|████████▊ | 67/76 [00:00<00:00, 4114.77it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.bias]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 4154.23it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  89%|████████▉ | 68/76 [00:00<00:00, 4141.98it/s, Materializing param=gpt_neox.layers.5.attention.query_key_value.weight]Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 4180.67it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]            Loading weights:  91%|█████████ | 69/76 [00:00<00:00, 4168.69it/s, Materializing param=gpt_neox.layers.5.input_layernorm.bias]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 4207.89it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  92%|█████████▏| 70/76 [00:00<00:00, 4196.10it/s, Materializing param=gpt_neox.layers.5.input_layernorm.weight]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4235.04it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  93%|█████████▎| 71/76 [00:00<00:00, 4223.45it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.bias]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4261.42it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  95%|█████████▍| 72/76 [00:00<00:00, 4247.40it/s, Materializing param=gpt_neox.layers.5.mlp.dense_4h_to_h.weight]Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4284.69it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]  Loading weights:  96%|█████████▌| 73/76 [00:00<00:00, 4272.85it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.bias]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4310.15it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  97%|█████████▋| 74/76 [00:00<00:00, 4298.51it/s, Materializing param=gpt_neox.layers.5.mlp.dense_h_to_4h.weight]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4335.29it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights:  99%|█████████▊| 75/76 [00:00<00:00, 4323.55it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.bias]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4359.86it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4347.79it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]Loading weights: 100%|██████████| 76/76 [00:00<00:00, 4323.97it/s, Materializing param=gpt_neox.layers.5.post_attention_layernorm.weight]
  RoPE replacement: 8 frequency pairs
  Old inv_freq: [1.0, 0.3162277638912201, 0.10000000149011612, 0.03162277862429619, 0.009999999776482582, 0.003162277862429619, 0.0010000000474974513, 0.0003162277862429619]
  New inv_freq (SPIRNOR): [3.1415927410125732, 2.094395160675049, 1.2566370964050293, 0.8975979089736938, 0.5711986422538757, 0.4833219349384308, 0.3695991337299347, 0.33069396018981934]
  Primes used: [2, 3, 5, 7, 11, 13, 17, 19]
  CRT product: 9,699,690
  Total params: 70,432,256
  Trainable params: 70,432,256
  Value aug params: 5,632

  Fine-tuning (10 epochs)...
    AMP dtype: torch.bfloat16, GradScaler: False
    Epoch  1/10: loss=1.5362, lr=2.00e-05, time=91s
    Epoch  2/10: loss=1.1160, lr=1.94e-05, time=179s
    Epoch  5/10: loss=0.6871, lr=1.17e-05, time=442s
    Epoch  8/10: loss=0.5316, lr=2.34e-06, time=705s
    Epoch 10/10: loss=0.4666, lr=0.00e+00, time=881s
  Training time: 881.4s

  Debug (3 examples):
    [mod7] prompt='466 mod 7 =' expected='4' got='4' clean='4' [OK]
    [gcd_task] prompt='gcd(466,322) =' expected='2' got='2' clean='2' [OK]
    [coprime] prompt='coprime(466,322) =' expected='no' got='no' clean='no' [OK]

  Evaluation (500 per task per range):
    in_range      : overall=0.7963  [mod7=1.000 mod30=0.996 gcd_task=0.848 isprime=0.982 add=0.000 coprime=0.952]
    ood_2k_5k     : overall=0.7410  [mod7=0.930 mod30=0.866 gcd_task=0.834 isprime=0.896 add=0.000 coprime=0.920]
    ood_5k_20k    : overall=0.7410  [mod7=0.902 mod30=0.912 gcd_task=0.816 isprime=0.890 add=0.000 coprime=0.926]
    ood_20k_100k  : overall=0.7210  [mod7=0.886 mod30=0.830 gcd_task=0.806 isprime=0.906 add=0.000 coprime=0.898]

======================================================================
PHASE 17 RESULTS SUMMARY
======================================================================

  Overall Accuracy (avg across 6 tasks)
  Config               |     Params |  In-Range |     2K-5K |    5K-20K |  20K-100K |   Avg OOD
  ---------------------------------------------------------------------------------------------
  zero_shot            | 70,426,624 | 0.0000    | 0.0010    | 0.0007    | 0.0000    | 0.0006   
  baseline_ft          | 70,426,624 | 0.6040    | 0.4040    | 0.4303    | 0.4203    | 0.4182   
  spirnor_rope_ft      | 70,426,624 | 0.5897    | 0.4813    | 0.4673    | 0.4827    | 0.4771   
  spirnor_value_ft     | 70,432,256 | 0.7957    | 0.7290    | 0.7477    | 0.7277    | 0.7348   
  spirnor_full_ft      | 70,432,256 | 0.7963    | 0.7410    | 0.7410    | 0.7210    | 0.7343   

----------------------------------------------------------------------
PER-TASK ACCURACY AT 2K-5K OOD
----------------------------------------------------------------------
  Config               |       mod7 |      mod30 |   gcd_task |    isprime |        add |    coprime
  --------------------------------------------------------------------------------------------------
  zero_shot            | 0.0040     | 0.0020     | 0.0000     | 0.0000     | 0.0000     | 0.0000    
  baseline_ft          | 0.1140     | 0.1880     | 0.6240     | 0.8400     | 0.0000     | 0.6580    
  spirnor_rope_ft      | 0.1380     | 0.2980     | 0.7620     | 0.8540     | 0.0000     | 0.8360    
  spirnor_value_ft     | 0.8840     | 0.8600     | 0.8420     | 0.8880     | 0.0000     | 0.9000    
  spirnor_full_ft      | 0.9300     | 0.8660     | 0.8340     | 0.8960     | 0.0000     | 0.9200    

----------------------------------------------------------------------
SPIRNOR ADVANTAGE vs BASELINE (2K-5K OOD)
----------------------------------------------------------------------

  spirnor_rope_ft:
    mod7      : 0.1380 vs 0.1140 (+0.0240, 1.2x)
    mod30     : 0.2980 vs 0.1880 (+0.1100, 1.6x)
    gcd_task  : 0.7620 vs 0.6240 (+0.1380, 1.2x)
    isprime   : 0.8540 vs 0.8400 (+0.0140, 1.0x)
    add       : 0.0000 vs 0.0000 (+0.0000)
    coprime   : 0.8360 vs 0.6580 (+0.1780, 1.3x)

  spirnor_value_ft:
    mod7      : 0.8840 vs 0.1140 (+0.7700, 7.8x)
    mod30     : 0.8600 vs 0.1880 (+0.6720, 4.6x)
    gcd_task  : 0.8420 vs 0.6240 (+0.2180, 1.3x)
    isprime   : 0.8880 vs 0.8400 (+0.0480, 1.1x)
    add       : 0.0000 vs 0.0000 (+0.0000)
    coprime   : 0.9000 vs 0.6580 (+0.2420, 1.4x)

  spirnor_full_ft:
    mod7      : 0.9300 vs 0.1140 (+0.8160, 8.2x)
    mod30     : 0.8660 vs 0.1880 (+0.6780, 4.6x)
    gcd_task  : 0.8340 vs 0.6240 (+0.2100, 1.3x)
    isprime   : 0.8960 vs 0.8400 (+0.0560, 1.1x)
    add       : 0.0000 vs 0.0000 (+0.0000)
    coprime   : 0.9200 vs 0.6580 (+0.2620, 1.4x)

----------------------------------------------------------------------
TRAINING EFFICIENCY
----------------------------------------------------------------------
  zero_shot           :    0.0s, 70,426,624 params, in-range=0.0000
  baseline_ft         :  230.9s, 70,426,624 params, in-range=0.6040
  spirnor_rope_ft     :  235.5s, 70,426,624 params, in-range=0.5897
  spirnor_value_ft    :  872.4s, 70,432,256 params, in-range=0.7957
  spirnor_full_ft     :  881.4s, 70,432,256 params, in-range=0.7963

Results saved to: SPIRNOR_AI_PHASE17_RESULTS.json

Total experiment time: 54.0 minutes
Phase 17 complete!
