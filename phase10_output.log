Using device: cuda
  GPU: NVIDIA GeForce RTX 4090
  VRAM: 25.4 GB
======================================================================
PHASE 10: SPIRNOR FOR AUTOREGRESSIVE ARITHMETIC
======================================================================
Vocabulary: 16 tokens
SPIRNOR constants: ['2pi/2', '2pi/3', '2pi/5', '2pi/7', '2pi/11']
Max sequence length: 30

Generating addition training data: 200000 examples, operands [1, 999]...
  Shape: torch.Size([200000, 30])
Generating multiplication training data: 200000 examples, operands [2, 99]...
  Shape: torch.Size([200000, 30])

======================================================================
PART A: ADDITION (train 1-999, OOD to 6-digit)
======================================================================

--- Config: baseline ---
  Parameters: 1,191,936
    Epoch   1/30: loss=2.9282, token_acc=0.3784, time=19s
    Epoch   5/30: loss=0.7162, token_acc=0.7173, time=88s
    Epoch  10/30: loss=0.0512, token_acc=0.9817, time=173s
    Epoch  15/30: loss=0.0179, token_acc=0.9937, time=259s
    Epoch  20/30: loss=0.0092, token_acc=0.9967, time=344s
    Epoch  25/30: loss=0.0059, token_acc=0.9980, time=425s
    Epoch  30/30: loss=0.0048, token_acc=0.9983, time=503s
  Training time: 503s
  in_range      : exact=1.000, digit=1.000, len=1.000
  4_digit       : exact=0.000, digit=0.131, len=0.000
  5_digit       : exact=0.000, digit=0.000, len=0.000
  6_digit       : exact=0.000, digit=0.001, len=0.000

--- Config: spirnor_aug ---
  Parameters: 1,196,544
    Epoch   1/30: loss=3.0474, token_acc=0.3874, time=15s
    Epoch   5/30: loss=0.6297, token_acc=0.7521, time=80s
    Epoch  10/30: loss=0.4582, token_acc=0.8105, time=164s
    Epoch  15/30: loss=0.2799, token_acc=0.8797, time=252s
    Epoch  20/30: loss=0.1552, token_acc=0.9363, time=338s
    Epoch  25/30: loss=0.1115, token_acc=0.9555, time=422s
    Epoch  30/30: loss=0.1007, token_acc=0.9604, time=502s
  Training time: 502s
  in_range      : exact=0.978, digit=0.992, len=1.000
  4_digit       : exact=0.000, digit=0.160, len=0.000
  5_digit       : exact=0.000, digit=0.022, len=0.000
  6_digit       : exact=0.000, digit=0.115, len=0.052

--- Config: learned_aug ---
  Parameters: 1,319,936
    Epoch   1/30: loss=3.1830, token_acc=0.3695, time=16s
    Epoch   5/30: loss=1.1512, token_acc=0.5528, time=84s
    Epoch  10/30: loss=0.9944, token_acc=0.6055, time=169s
    Epoch  15/30: loss=0.9155, token_acc=0.6311, time=255s
    Epoch  20/30: loss=0.8654, token_acc=0.6495, time=342s
    Epoch  25/30: loss=0.8373, token_acc=0.6608, time=428s
    Epoch  30/30: loss=0.8278, token_acc=0.6650, time=511s
  Training time: 511s
  in_range      : exact=0.087, digit=0.647, len=0.998
  4_digit       : exact=0.000, digit=0.150, len=0.000
  5_digit       : exact=0.000, digit=0.000, len=0.000
  6_digit       : exact=0.000, digit=0.000, len=0.000

--- Config: std_rope ---
  Parameters: 1,191,936
    Epoch   1/30: loss=2.9465, token_acc=0.4066, time=17s
    Epoch   5/30: loss=0.1235, token_acc=0.9547, time=85s
    Epoch  10/30: loss=0.0476, token_acc=0.9815, time=171s
    Epoch  15/30: loss=0.0193, token_acc=0.9931, time=259s
    Epoch  20/30: loss=0.0112, token_acc=0.9961, time=346s
    Epoch  25/30: loss=0.0078, token_acc=0.9972, time=434s
    Epoch  30/30: loss=0.0068, token_acc=0.9976, time=517s
  Training time: 517s
  in_range      : exact=0.991, digit=0.997, len=1.000
  4_digit       : exact=0.000, digit=0.151, len=0.074
  5_digit       : exact=0.000, digit=0.082, len=0.000
  6_digit       : exact=0.000, digit=0.093, len=0.000

--- Config: spirnor_rope ---
  Parameters: 1,191,936
    Epoch   1/30: loss=2.9949, token_acc=0.4433, time=19s
    Epoch   5/30: loss=0.0788, token_acc=0.9692, time=87s
    Epoch  10/30: loss=0.0268, token_acc=0.9902, time=174s
    Epoch  15/30: loss=0.0131, token_acc=0.9955, time=260s
    Epoch  20/30: loss=0.0071, token_acc=0.9975, time=349s
    Epoch  25/30: loss=0.0044, token_acc=0.9986, time=436s
    Epoch  30/30: loss=0.0036, token_acc=0.9988, time=523s
  Training time: 523s
  in_range      : exact=1.000, digit=1.000, len=1.000
  4_digit       : exact=0.000, digit=0.102, len=0.037
  5_digit       : exact=0.000, digit=0.077, len=0.000
  6_digit       : exact=0.000, digit=0.078, len=0.000

--- Config: spirnor_full ---
  Parameters: 1,196,544
    Epoch   1/30: loss=3.0626, token_acc=0.4048, time=20s
    Epoch   5/30: loss=0.1080, token_acc=0.9601, time=86s
    Epoch  10/30: loss=0.0171, token_acc=0.9942, time=175s
    Epoch  15/30: loss=0.0066, token_acc=0.9978, time=262s
    Epoch  20/30: loss=0.0034, token_acc=0.9989, time=349s
    Epoch  25/30: loss=0.0020, token_acc=0.9993, time=435s
    Epoch  30/30: loss=0.0014, token_acc=0.9995, time=522s
  Training time: 522s
  in_range      : exact=1.000, digit=1.000, len=1.000
  4_digit       : exact=0.000, digit=0.116, len=0.038
  5_digit       : exact=0.000, digit=0.087, len=0.003
  6_digit       : exact=0.000, digit=0.102, len=0.000

======================================================================
PART B: MULTIPLICATION (train 2-99, OOD to 3-digit)
======================================================================

--- Config: baseline ---
  Parameters: 1,191,936
    Epoch   1/30: loss=3.1344, token_acc=0.3542, time=19s
    Epoch   5/30: loss=0.5749, token_acc=0.7813, time=90s
    Epoch  10/30: loss=0.2056, token_acc=0.9232, time=175s
    Epoch  15/30: loss=0.0879, token_acc=0.9682, time=260s
    Epoch  20/30: loss=0.0520, token_acc=0.9814, time=349s
    Epoch  25/30: loss=0.0392, token_acc=0.9864, time=436s
    Epoch  30/30: loss=0.0345, token_acc=0.9881, time=524s
  Training time: 524s
  in_range      : exact=1.000, digit=1.000, len=1.000
  3_digit       : exact=0.000, digit=0.035, len=0.000
  3_digit_mix   : exact=0.010, digit=0.066, len=0.029

--- Config: spirnor_aug ---
  Parameters: 1,196,544
    Epoch   1/30: loss=2.9080, token_acc=0.3821, time=17s
    Epoch   5/30: loss=0.6700, token_acc=0.7428, time=87s
    Epoch  10/30: loss=0.1780, token_acc=0.9373, time=176s
    Epoch  15/30: loss=0.0449, token_acc=0.9849, time=263s
    Epoch  20/30: loss=0.0217, token_acc=0.9929, time=348s
    Epoch  25/30: loss=0.0140, token_acc=0.9954, time=432s
    Epoch  30/30: loss=0.0119, token_acc=0.9961, time=517s
  Training time: 517s
  in_range      : exact=1.000, digit=1.000, len=1.000
  3_digit       : exact=0.000, digit=0.059, len=0.000
  3_digit_mix   : exact=0.011, digit=0.078, len=0.026

--- Config: learned_aug ---
  Parameters: 1,204,736
    Epoch   1/30: loss=3.1670, token_acc=0.3713, time=16s
    Epoch   5/30: loss=0.4720, token_acc=0.8242, time=82s
    Epoch  10/30: loss=0.0695, token_acc=0.9766, time=171s
    Epoch  15/30: loss=0.0210, token_acc=0.9931, time=259s
    Epoch  20/30: loss=0.0105, token_acc=0.9966, time=346s
    Epoch  25/30: loss=0.0064, token_acc=0.9979, time=431s
    Epoch  30/30: loss=0.0049, token_acc=0.9985, time=517s
  Training time: 517s
  in_range      : exact=1.000, digit=1.000, len=1.000
  3_digit       : exact=0.000, digit=0.028, len=0.000
  3_digit_mix   : exact=0.009, digit=0.044, len=0.009

--- Config: std_rope ---
  Parameters: 1,191,936
    Epoch   1/30: loss=3.1524, token_acc=0.3710, time=17s
    Epoch   5/30: loss=0.5497, token_acc=0.7826, time=89s
    Epoch  10/30: loss=0.2372, token_acc=0.9094, time=186s
    Epoch  15/30: loss=0.1159, token_acc=0.9577, time=301s
    Epoch  20/30: loss=0.0729, token_acc=0.9741, time=390s
    Epoch  25/30: loss=0.0563, token_acc=0.9803, time=476s
    Epoch  30/30: loss=0.0511, token_acc=0.9820, time=566s
  Training time: 566s
  in_range      : exact=1.000, digit=1.000, len=1.000
  3_digit       : exact=0.000, digit=0.137, len=0.000
  3_digit_mix   : exact=0.012, digit=0.157, len=0.031

--- Config: spirnor_rope ---
  Parameters: 1,191,936
    Epoch   1/30: loss=2.9909, token_acc=0.4049, time=18s
    Epoch   5/30: loss=0.5007, token_acc=0.8052, time=89s
    Epoch  10/30: loss=0.2029, token_acc=0.9234, time=181s
    Epoch  15/30: loss=0.0986, token_acc=0.9641, time=269s
    Epoch  20/30: loss=0.0626, token_acc=0.9775, time=360s
    Epoch  25/30: loss=0.0493, token_acc=0.9825, time=446s
    Epoch  30/30: loss=0.0448, token_acc=0.9842, time=537s
  Training time: 537s
  in_range      : exact=0.999, digit=1.000, len=1.000
  3_digit       : exact=0.000, digit=0.065, len=0.000
  3_digit_mix   : exact=0.010, digit=0.077, len=0.027

--- Config: spirnor_full ---
  Parameters: 1,196,544
    Epoch   1/30: loss=2.9174, token_acc=0.4041, time=17s
    Epoch   5/30: loss=0.5089, token_acc=0.8045, time=88s
    Epoch  10/30: loss=0.1468, token_acc=0.9474, time=177s
    Epoch  15/30: loss=0.0518, token_acc=0.9824, time=267s
    Epoch  20/30: loss=0.0270, token_acc=0.9909, time=356s
    Epoch  25/30: loss=0.0187, token_acc=0.9939, time=441s
    Epoch  30/30: loss=0.0168, token_acc=0.9945, time=532s
  Training time: 532s
  in_range      : exact=1.000, digit=1.000, len=1.000
  3_digit       : exact=0.000, digit=0.063, len=0.000
  3_digit_mix   : exact=0.009, digit=0.066, len=0.019

======================================================================
SUMMARY: ADDITION — Exact Match Accuracy
======================================================================
Config           |     in_range |      4_digit |      5_digit |      6_digit
----------------------------------------------------------------------------
baseline         |       1.000 |       0.000 |       0.000 |       0.000
spirnor_aug      |       0.978 |       0.000 |       0.000 |       0.000
learned_aug      |       0.087 |       0.000 |       0.000 |       0.000
std_rope         |       0.991 |       0.000 |       0.000 |       0.000
spirnor_rope     |       1.000 |       0.000 |       0.000 |       0.000
spirnor_full     |       1.000 |       0.000 |       0.000 |       0.000

            SUMMARY: MULTIPLICATION — Exact Match Accuracy            
======================================================================
Config           |       in_range |        3_digit |    3_digit_mix
-------------------------------------------------------------------
baseline         |         1.000 |         0.000 |         0.010
spirnor_aug      |         1.000 |         0.000 |         0.011
learned_aug      |         1.000 |         0.000 |         0.009
std_rope         |         1.000 |         0.000 |         0.012
spirnor_rope     |         0.999 |         0.000 |         0.010
spirnor_full     |         1.000 |         0.000 |         0.009

======================================================================
SPIRNOR ADVANTAGE ANALYSIS
======================================================================

1. Value Augmentation: spirnor_aug vs learned_aug
   ADD in_range    : spirnor=0.978, learned=0.087, delta=+0.891
   ADD 4_digit     : spirnor=0.000, learned=0.000, delta=+0.000
   ADD 5_digit     : spirnor=0.000, learned=0.000, delta=+0.000
   ADD 6_digit     : spirnor=0.000, learned=0.000, delta=+0.000

2. Position Encoding: spirnor_rope vs std_rope
   ADD in_range    : spirnor=1.000, standard=0.991, delta=+0.009
   ADD 4_digit     : spirnor=0.000, standard=0.000, delta=+0.000
   ADD 5_digit     : spirnor=0.000, standard=0.000, delta=+0.000
   ADD 6_digit     : spirnor=0.000, standard=0.000, delta=+0.000

3. Best SPIRNOR vs Baseline
   ADD in_range    : best_spirnor(spirnor_rope)=1.000, baseline=1.000, delta=+0.000
   ADD 4_digit     : best_spirnor()=0.000, baseline=0.000, delta=+0.000
   ADD 5_digit     : best_spirnor()=0.000, baseline=0.000, delta=+0.000
   ADD 6_digit     : best_spirnor()=0.000, baseline=0.000, delta=+0.000

Results saved to SPIRNOR_AI_PHASE10_RESULTS.json
