Using device: cuda
  GPU: NVIDIA GeForce RTX 4090
  VRAM: 25.3 GB
All curve verifications passed!
  E7a: 7 points (order 7), G=(3, 2)
  E7b: 8 points (order 8), G=(3, 3)
  E11: 13 points (order 13), G=(2, 4)
======================================================================
PHASE 16 PART A: ELLIPTIC CURVE CRYPTOGRAPHY (d_model=128)
2 embedding configs x 8 ECC tasks
======================================================================

Generating training data (range (2, 2000), 50000 per task x 8 tasks)...
  400,000 examples
    isoncurve7        : 50,000 examples
    isoncurve11       : 50,000 examples
    pointaddx7        : 50,000 examples
    scalarmulx7       : 50,000 examples
    scalarmulidx11    : 50,000 examples
    ecdlp7            : 50,000 examples
    ecdlp11           : 50,000 examples
    ecdh7             : 50,000 examples
    isoncurve7         labels: 0-1, n_unique=2/2
    isoncurve11        labels: 0-1, n_unique=2/2
    pointaddx7         labels: 0-7, n_unique=5/8
    scalarmulx7        labels: 3-7, n_unique=4/8
    scalarmulidx11     labels: 0-12, n_unique=13/13
    ecdlp7             labels: 0-5, n_unique=6/6
    ecdlp11            labels: 0-11, n_unique=12/12
    ecdh7              labels: 0-6, n_unique=7/7

Generating test data...
  in_range          : 8,000 examples (range 2-2,000)
  ood_2k_5k         : 8,000 examples (range 2,001-5,000)
  ood_5k_20k        : 8,000 examples (range 5,001-20,000)
  ood_20k_100k      : 8,000 examples (range 20,001-100,000)
  ood_100k_500k     : 8,000 examples (range 100,001-500,000)

======================================================================
TRAINING AND EVALUATION (2 configurations)
Architecture: 6-layer Transformer, d_model=128, 4 heads, 30 epochs
======================================================================

============================================================
[1/2] spirnor_rational5
============================================================

  --------------------------------------------------------
  CONFIG: spirnor_rational5
  SPIRNOR with rational_5 {2pi/2,3,5,7,11}
  d_model=128, nhead=4, num_layers=6
  --------------------------------------------------------
    Epoch   1/30: loss=0.8023, acc=0.666
    Epoch   5/30: loss=0.2886, acc=0.894
    Epoch  10/30: loss=0.0798, acc=0.970
    Epoch  15/30: loss=0.0064, acc=0.998
    Epoch  20/30: loss=0.0016, acc=1.000
    Epoch  25/30: loss=0.0007, acc=1.000
    Epoch  30/30: loss=0.0004, acc=1.000
  Training time: 335.1s, Params: 1,335,226

  Evaluation:
    in_range          : overall=1.0000  [IsOnCurve7=1.000 IsOnCurve11=1.000 PointAddX7=1.000 ScalarMulX7=1.000 ScalarMulIdx11=1.000 ECDLP7=1.000 ECDLP11=1.000 ECDH7=1.000]
    ood_2k_5k         : overall=0.8794  [IsOnCurve7=1.000 IsOnCurve11=1.000 PointAddX7=1.000 ScalarMulX7=1.000 ScalarMulIdx11=0.035 ECDLP7=1.000 ECDLP11=1.000 ECDH7=1.000]
    ood_5k_20k        : overall=0.8812  [IsOnCurve7=1.000 IsOnCurve11=1.000 PointAddX7=0.979 ScalarMulX7=1.000 ScalarMulIdx11=0.071 ECDLP7=1.000 ECDLP11=1.000 ECDH7=1.000]
    ood_20k_100k      : overall=0.8734  [IsOnCurve7=1.000 IsOnCurve11=0.995 PointAddX7=0.926 ScalarMulX7=1.000 ScalarMulIdx11=0.071 ECDLP7=1.000 ECDLP11=0.999 ECDH7=0.996]
    ood_100k_500k     : overall=0.8634  [IsOnCurve7=0.998 IsOnCurve11=0.998 PointAddX7=0.872 ScalarMulX7=1.000 ScalarMulIdx11=0.076 ECDLP7=0.996 ECDLP11=0.995 ECDH7=0.972]

============================================================
[2/2] learned
============================================================

  --------------------------------------------------------
  CONFIG: learned
  Learned embedding (nn.Embedding baseline)
  d_model=128, nhead=4, num_layers=6
  --------------------------------------------------------
    Epoch   1/30: loss=1.3955, acc=0.404
    Epoch   5/30: loss=0.1341, acc=0.941
    Epoch  10/30: loss=0.0201, acc=0.993
    Epoch  15/30: loss=0.0061, acc=0.998
    Epoch  20/30: loss=0.0023, acc=0.999
    Epoch  25/30: loss=0.0010, acc=1.000
    Epoch  30/30: loss=0.0007, acc=1.000
  Training time: 327.6s, Params: 1,586,618

  Evaluation:
    in_range          : overall=0.9994  [IsOnCurve7=1.000 IsOnCurve11=0.995 PointAddX7=1.000 ScalarMulX7=1.000 ScalarMulIdx11=1.000 ECDLP7=1.000 ECDLP11=1.000 ECDH7=1.000]
    ood_2k_5k         : overall=0.2046  [IsOnCurve7=0.463 IsOnCurve11=0.496 PointAddX7=0.207 ScalarMulX7=0.137 ScalarMulIdx11=0.000 ECDLP7=0.128 ECDLP11=0.084 ECDH7=0.122]
    ood_5k_20k        : overall=0.2340  [IsOnCurve7=0.510 IsOnCurve11=0.515 PointAddX7=0.254 ScalarMulX7=0.237 ScalarMulIdx11=0.001 ECDLP7=0.170 ECDLP11=0.025 ECDH7=0.160]
    ood_20k_100k      : overall=0.2549  [IsOnCurve7=0.526 IsOnCurve11=0.525 PointAddX7=0.213 ScalarMulX7=0.276 ScalarMulIdx11=0.086 ECDLP7=0.158 ECDLP11=0.088 ECDH7=0.167]
    ood_100k_500k     : overall=0.2479  [IsOnCurve7=0.495 IsOnCurve11=0.515 PointAddX7=0.220 ScalarMulX7=0.257 ScalarMulIdx11=0.077 ECDLP7=0.164 ECDLP11=0.081 ECDH7=0.174]

======================================================================
PHASE 16 PART B: SCALING TEST (d_model=256)
2 configs at larger model scale
======================================================================

Generating training data for scaling test...
  400,000 examples
Generating test data...

============================================================
[1/2] spirnor_256 (d_model=256)
============================================================

  --------------------------------------------------------
  CONFIG: spirnor_256
  SPIRNOR with rational_5 {2pi/2,3,5,7,11}
  d_model=256, nhead=8, num_layers=6
  --------------------------------------------------------
    Epoch   1/30: loss=0.5628, acc=0.776
    Epoch   5/30: loss=0.0962, acc=0.961
    Epoch  10/30: loss=0.0081, acc=0.997
    Epoch  15/30: loss=0.0042, acc=0.999
    Epoch  20/30: loss=0.0012, acc=1.000
    Epoch  25/30: loss=0.0000, acc=1.000
    Epoch  30/30: loss=0.0000, acc=1.000
  Training time: 593.1s, Params: 5,291,834

  Evaluation:
    in_range          : overall=1.0000  [IsOnCurve7=1.000 IsOnCurve11=1.000 PointAddX7=1.000 ScalarMulX7=1.000 ScalarMulIdx11=1.000 ECDLP7=1.000 ECDLP11=1.000 ECDH7=1.000]
    ood_2k_5k         : overall=0.8792  [IsOnCurve7=1.000 IsOnCurve11=1.000 PointAddX7=1.000 ScalarMulX7=1.000 ScalarMulIdx11=0.034 ECDLP7=1.000 ECDLP11=1.000 ECDH7=1.000]
    ood_5k_20k        : overall=0.8800  [IsOnCurve7=1.000 IsOnCurve11=0.999 PointAddX7=1.000 ScalarMulX7=1.000 ScalarMulIdx11=0.043 ECDLP7=1.000 ECDLP11=0.999 ECDH7=0.999]
    ood_20k_100k      : overall=0.8820  [IsOnCurve7=1.000 IsOnCurve11=1.000 PointAddX7=0.996 ScalarMulX7=1.000 ScalarMulIdx11=0.064 ECDLP7=1.000 ECDLP11=0.997 ECDH7=0.999]
    ood_100k_500k     : overall=0.8799  [IsOnCurve7=1.000 IsOnCurve11=0.996 PointAddX7=0.984 ScalarMulX7=1.000 ScalarMulIdx11=0.074 ECDLP7=0.999 ECDLP11=0.992 ECDH7=0.994]

============================================================
[2/2] learned_256 (d_model=256)
============================================================

  --------------------------------------------------------
  CONFIG: learned_256
  Learned embedding (nn.Embedding baseline)
  d_model=256, nhead=8, num_layers=6
  --------------------------------------------------------
    Epoch   1/30: loss=0.8220, acc=0.638
    Epoch   5/30: loss=0.0096, acc=0.997
    Epoch  10/30: loss=0.0043, acc=0.999
    Epoch  15/30: loss=0.0012, acc=1.000
    Epoch  20/30: loss=0.0004, acc=1.000
    Epoch  25/30: loss=0.0000, acc=1.000
    Epoch  30/30: loss=0.0000, acc=1.000
  Training time: 548.8s, Params: 5,794,618

  Evaluation:
    in_range          : overall=0.9998  [IsOnCurve7=1.000 IsOnCurve11=0.998 PointAddX7=1.000 ScalarMulX7=1.000 ScalarMulIdx11=1.000 ECDLP7=1.000 ECDLP11=1.000 ECDH7=1.000]
    ood_2k_5k         : overall=0.1915  [IsOnCurve7=0.463 IsOnCurve11=0.499 PointAddX7=0.212 ScalarMulX7=0.137 ScalarMulIdx11=0.000 ECDLP7=0.045 ECDLP11=0.053 ECDH7=0.123]
    ood_5k_20k        : overall=0.2335  [IsOnCurve7=0.509 IsOnCurve11=0.514 PointAddX7=0.234 ScalarMulX7=0.237 ScalarMulIdx11=0.000 ECDLP7=0.173 ECDLP11=0.041 ECDH7=0.160]
    ood_20k_100k      : overall=0.2586  [IsOnCurve7=0.526 IsOnCurve11=0.525 PointAddX7=0.222 ScalarMulX7=0.277 ScalarMulIdx11=0.086 ECDLP7=0.176 ECDLP11=0.090 ECDH7=0.167]
    ood_100k_500k     : overall=0.2490  [IsOnCurve7=0.495 IsOnCurve11=0.514 PointAddX7=0.238 ScalarMulX7=0.257 ScalarMulIdx11=0.077 ECDLP7=0.168 ECDLP11=0.069 ECDH7=0.174]

======================================================================
PHASE 16 RESULTS SUMMARY
======================================================================

  PART A: Overall Accuracy (d_model=128)
  Config               |     Params |  In-Range |     2K-5K |    5K-20K |  20K-100K | 100K-500K |   Avg OOD
  ---------------------------------------------------------------------------------------------------------
  spirnor_rational5    |  1,335,226 | 1.0000    | 0.8794    | 0.8812    | 0.8734    | 0.8634    | 0.8743   
  learned              |  1,586,618 | 0.9994    | 0.2046    | 0.2340    | 0.2549    | 0.2479    | 0.2354   

----------------------------------------------------------------------
PER-FAMILY ANALYSIS (2K-5K OOD)
----------------------------------------------------------------------

  Family 1_Validation: Point Validation
    spirnor_rational5   : avg=1.0000  [IsOnCurve7=1.000, IsOnCurve11=1.000]
    learned             : avg=0.4795  [IsOnCurve7=0.463, IsOnCurve11=0.496]

  Family 2_PointArith: Point Arithmetic
    spirnor_rational5   : avg=1.0000  [PointAddX7=1.000]
    learned             : avg=0.2070  [PointAddX7=0.207]

  Family 3_ScalarMul: Scalar Multiplication
    spirnor_rational5   : avg=0.5175  [ScalarMulX7=1.000, ScalarMulIdx11=0.035]
    learned             : avg=0.0685  [ScalarMulX7=0.137, ScalarMulIdx11=0.000]

  Family 4_ECDLP: EC Discrete Logarithm
    spirnor_rational5   : avg=1.0000  [ECDLP7=1.000, ECDLP11=1.000]
    learned             : avg=0.1060  [ECDLP7=0.128, ECDLP11=0.084]

  Family 5_ECDH: EC Diffie-Hellman
    spirnor_rational5   : avg=1.0000  [ECDH7=1.000]
    learned             : avg=0.1220  [ECDH7=0.122]

----------------------------------------------------------------------
FULL PER-TASK BREAKDOWN AT 2K-5K
----------------------------------------------------------------------
  Config               |     IsOnCurve7 |    IsOnCurve11 |     PointAddX7 |    ScalarMulX7 | ScalarMulIdx11 |         ECDLP7 |        ECDLP11 |          ECDH7
  ------------------------------------------------------------------------------------------------------------------------------------------------------------
  spirnor_rational5    | 1.0000         | 1.0000         | 1.0000         | 1.0000         | 0.0350         | 1.0000         | 1.0000         | 1.0000        
  learned              | 0.4630         | 0.4960         | 0.2070         | 0.1370         | 0.0000         | 0.1280         | 0.0840         | 0.1220        

----------------------------------------------------------------------
SPIRNOR ADVANTAGE AT 2K-5K OOD
----------------------------------------------------------------------
  IsOnCurve7    : SPIRNOR=1.0000, Learned=0.4630, diff=+0.5370, ratio=2.2x
  IsOnCurve11   : SPIRNOR=1.0000, Learned=0.4960, diff=+0.5040, ratio=2.0x
  PointAddX7    : SPIRNOR=1.0000, Learned=0.2070, diff=+0.7930, ratio=4.8x
  ScalarMulX7   : SPIRNOR=1.0000, Learned=0.1370, diff=+0.8630, ratio=7.3x
  ScalarMulIdx11: SPIRNOR=0.0350, Learned=0.0000, diff=+0.0350, ratio=infx
  ECDLP7        : SPIRNOR=1.0000, Learned=0.1280, diff=+0.8720, ratio=7.8x
  ECDLP11       : SPIRNOR=1.0000, Learned=0.0840, diff=+0.9160, ratio=11.9x
  ECDH7         : SPIRNOR=1.0000, Learned=0.1220, diff=+0.8780, ratio=8.2x

----------------------------------------------------------------------
SPIRNOR SCALE INVARIANCE (per-task across OOD ranges)
----------------------------------------------------------------------
  IsOnCurve7    : [1.000, 1.000, 1.000, 0.998] drop=+0.002
  IsOnCurve11   : [1.000, 1.000, 0.995, 0.998] drop=+0.002
  PointAddX7    : [1.000, 0.979, 0.926, 0.872] drop=+0.128
  ScalarMulX7   : [1.000, 1.000, 1.000, 1.000] drop=+0.000
  ScalarMulIdx11: [0.035, 0.071, 0.071, 0.076] drop=-0.041
  ECDLP7        : [1.000, 1.000, 1.000, 0.996] drop=+0.004
  ECDLP11       : [1.000, 1.000, 0.999, 0.995] drop=+0.005
  ECDH7         : [1.000, 1.000, 0.996, 0.972] drop=+0.028

======================================================================
PART B: SCALING TEST (d_model=256)
======================================================================
  Config               |     Params |  In-Range |     2K-5K |    5K-20K |  20K-100K | 100K-500K |   Avg OOD
  ---------------------------------------------------------------------------------------------------------
  spirnor_256          |  5,291,834 | 1.0000    | 0.8792    | 0.8800    | 0.8820    | 0.8799    | 0.8803   
  learned_256          |  5,794,618 | 0.9998    | 0.1915    | 0.2335    | 0.2586    | 0.2490    | 0.2331   

  Scaling Comparison (d_model=128 -> 256):
    spirnor_rational5   : 0.8743 -> 0.8803 (+0.0059)
    learned             : 0.2354 -> 0.2331 (-0.0022)

======================================================================
KEY FINDINGS
======================================================================
  spirnor_rational5   : in_range=1.0000, avg_OOD=0.8743
  learned             : in_range=0.9994, avg_OOD=0.2354

  ECC TASK VALIDATION (SPIRNOR @ 100K-500K):
    IsOnCurve7    : 0.9980 [EXACT] #############################
    IsOnCurve11   : 0.9980 [EXACT] #############################
    PointAddX7    : 0.8720 [MODERATE] ##########################
    ScalarMulX7   : 1.0000 [EXACT] ##############################
    ScalarMulIdx11: 0.0760 [WEAK] ##
    ECDLP7        : 0.9960 [EXACT] #############################
    ECDLP11       : 0.9950 [EXACT] #############################
    ECDH7         : 0.9720 [STRONG] #############################

Results saved to: SPIRNOR_AI_PHASE16_RESULTS.json

Total experiment time: 30.2 minutes
Phase 16 complete!
